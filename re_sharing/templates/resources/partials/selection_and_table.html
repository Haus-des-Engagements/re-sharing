{% load i18n %}

<form id="resources"
      hx-get="{% url 'resources:planner' %}"
      hx-target="#planner-table"
      hx-indicator="#spinner"
      hx-headers='{"partial": "planner-table"}'
      hx-push-url="true"
      hx-swap="innerHTML"
      hx-trigger="change"
      hx-sync="closest form:replace">
  <div class="row g-4">
    {% for access, resources in grouped_resources.items %}
      <div class="col-auto ms-2">
        {{ access }}:
        {% for resource in resources %}
          <div class="form-check">
            <input class="form-check-input"
                   type="checkbox"
                   id="resource-{{ resource.slug }}"
                   name="resources"
                   value="{{ resource.slug }}"
                   {% if resource in selected_resources %}checked{% endif %} />
            <label for="resource-{{ resource.slug }}" class="form-check-label">{{ resource.name }}</label>
          </div>
        {% endfor %}
      </div>
    {% endfor %}
  </div>
  <div class="row g-2 mt-4 justify-content-between">
    <div class="row g-2 col-auto">
      <div id="div_date" class="col-auto">
        <label for="date" class="form-label visually-hidden">{% trans "Date" %}</label>
        <input type="date"
               name="date"
               class="form-control textinput form-control"
               placeholder="{% trans 'Date' %}"
               id="date"
               value="{{ dates.shown_date|date:'Y-m-d' }}" />
      </div>
      <div class="col-auto" id="div_id_selected_nb_of_days">
        <label for="id_selected_nb_of_days" class="form-label visually-hidden">{% trans "Days to display" %}</label>
        <select name="selected_nb_of_days"
                class="select form-select form-select"
                id="id_selected_nb_of_days">
          {% for number in nb_of_days %}
            <option value={{ number }} {% if number == selected_nb_of_days %}selected{% endif %}>{{ number }} {% trans "days" %}
            </option>
          {% endfor %}
        </select>
      </div>
      <div id="spinner"
           class="spinner-border col-auto htmx-indicator d-flex align-self-center ms-4"
           role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
    <div class="col-auto hstack gap-3">
      <div class="p-2 border small bookable">{% trans "bookable" %}</div>
      <div class="p-2 border small restricted">{% trans "restricted" %}</div>
      <div class="p-2 border small booked">{% trans "booked" %}</div>
      {% if request.user.is_authenticated %}
        <div class="p-2 border small booked-by-me">{% trans "booked by me" %}</div>
      {% endif %}
      <div class="p-2 border small past">{% trans "past" %}</div>
    </div>
  </div>
</form>
<div id="planner-table" class="row g-2 d-flex mt-1">{% include "resources/partials/multi_planner_table.html" %}</div>
