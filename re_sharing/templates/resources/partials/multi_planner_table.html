{% load i18n %}

<div id="planner-table" class="row g-2 d-flex">
  <div class="table-responsive">
    <!-- Iterate through each weekday group -->
    {% for day, day_data in planner_data.items %}
      <table class="table table-sm table-sm-little-padding mb-0 table-bordered border-secondary small">
        <thead>
          <tr class="table-light">
            <th>{{ day|date:"l, d.m.y" }}</th>
            {% for timeslot in day_data.resources.0.timeslots %}
              {% if not forloop.counter|divisibleby:2 %}<th colspan="2">{{ timeslot.time|date:"H:i" }}</th>{% endif %}
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          <!-- Iterate through resources -->
          {% for resource in day_data.resources %}
            <tr class="w-25">
              <td class="table-light w-25 text-truncate">{{ resource.name }}</td>
              {% for timeslot in resource.timeslots %}
                {% if timeslot.booked %}
                  <td class="table-danger" title="{{ timeslot.organization }}">
                    {% if timeslot.link %}
                      <a href="{{ timeslot.link }}" class="cover-link">&nbsp</a>
                    {% else %}
                      &nbsp
                    {% endif %}
                  </td>
                {% elif not timeslot.bookable %}
                  <td class="table-secondary"></td>
                {% else %}
                  <td class="table-success">
                    <a href="{% url 'bookings:create-booking' %}{{ timeslot.link }}"
                       class="cover-link">&nbsp
                      <span class="visually-hidden">Book resource on {{ timeslot.time|date:"d.m.y H:i" }}</span></a>
                  </td>
                {% endif %}
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endfor %}
  </div>
</div>
